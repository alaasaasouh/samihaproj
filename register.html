<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Samiha Zeindine Coaching</title>
    <link rel="stylesheet" href="css/loginForm.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>

    <!-- Dashboard-style header (Home + Logout + Language) -->
    <header class="dashboard-header">
        <div class="header-left">
            <span data-i18n="appName">Samiha Zeindine Coaching</span>
        </div>
        <div class="header-right">
            <a href="index.html" class="top-nav-link" data-i18n="navHome">Home</a>
            <a href="logout.html" class="top-nav-link" data-i18n="navLogout">Logout</a>
            <select class="language-selector" id="languageSelector">
                <option value="en">EN</option>
                <option value="fr">FR</option>
                <option value="ar">AR</option>
            </select>
        </div>
    </header>

    <main class="login-page">
        <h1 class="login-title" data-i18n="registerTitle">Register</h1>

        <!-- TURNED INTO A REAL FORM -->
        <form id="registerForm" class="login-form">
            <!-- Social register / top block -->
            <div class="form1">
                <h2 data-i18n="registerWith">Register With</h2>

                <a class="fa fa-google-plus icons" style="font-size: 26px;" href="https://www.gmail.com/" target="_blank"></a>

                <div class="OR">
                    <p data-i18n="orText">Or</p>
                </div>
            </div>

            <!-- Fields -->
            <div class="fields">
                <div class="field-row">
                    <i class="fa fa-user-circle-o" style="font-size: 20px" aria-hidden="true"></i>
                    <input
                        id="regName"
                        type="text"
                        name="fullname"
                        placeholder="Full name..."
                        data-i18n-placeholder="placeholderFullname"
                        required>
                </div>

                <div class="field-row">
                    <i class="fa fa-envelope" style="font-size: 20px" aria-hidden="true"></i>
                    <input
                        id="regEmail"
                        type="email"
                        name="email"
                        placeholder="Email..."
                        data-i18n-placeholder="placeholderEmail"
                        required>
                </div>

                <div class="field-row">
                    <i class="fa fa-lock" style="font-size: 24px" aria-hidden="true"></i>
                    <input
                        id="regPassword"
                        type="password"
                        name="password"
                        placeholder="Password..."
                        data-i18n-placeholder="placeholderPassword"
                        required>
                </div>

                <div class="field-row">
                    <i class="fa fa-lock" style="font-size: 24px" aria-hidden="true"></i>
                    <input
                        id="regConfirmPassword"
                        type="password"
                        name="confirmPassword"
                        placeholder="Confirm password..."
                        data-i18n-placeholder="placeholderConfirmPassword"
                        required>
                </div>
            </div>

            <!-- Error / Success messages -->
            <div id="registerError" style="color:#b71c1c; font-size:0.85rem; margin-bottom:8px;"></div>
            <div id="registerSuccess" style="color:#1b5e20; font-size:0.85rem; margin-bottom:8px;"></div>

            <!-- Bottom area: Register + Go to Login -->
            <div class="form-footer">
                <div class="form-actions">
                    <!-- NOW A REAL SUBMIT BUTTON -->
                    <button type="submit" class="btn-auth btn-login" data-i18n="btnRegisterSubmit">
                        Create Account
                    </button>
                    <a href="login.html" class="btn-auth btn-register" data-i18n="btnGoToLogin">
                        Back to Login
                    </a>
                </div>
            </div>
        </form>

        <div class="footer-note" data-i18n="footerNote">
            &copy; 2025 Samiha Zeindine. All rights reserved.
        </div>
    </main>

    <!-- ============================================
         LANGUAGE TRANSLATION SCRIPT
         ============================================ -->
    <script>
        const translations = {
            en: {
                appName: "Samiha Zeindine Coaching",
                navHome: "Home",
                navLogout: "Logout",

                // Login page keys (also here so same JS can be reused)
                loginTitle: "Login",
                loginWith: "Login With",
                orText: "Or",
                placeholderUsername: "Username...",
                placeholderEmail: "Email...",
                placeholderPassword: "Password...",
                btnLogin: "Login",
                btnRegister: "Register",
                forgotPassword: "FORGOT PASSWORD?",
                footerNote: "© 2025 Samiha Zeindine. All rights reserved.",

                // Register page keys
                registerTitle: "Register",
                registerWith: "Register With",
                placeholderFullname: "Full name...",
                placeholderConfirmPassword: "Confirm password...",
                btnRegisterSubmit: "Create Account",
                btnGoToLogin: "Back to Login"
            },
            fr: {
                appName: "Coaching Samiha Zeindine",
                navHome: "Accueil",
                navLogout: "Déconnexion",

                // Login page keys
                loginTitle: "Connexion",
                loginWith: "Se connecter avec",
                orText: "Ou",
                placeholderUsername: "Nom d'utilisateur...",
                placeholderEmail: "E-mail...",
                placeholderPassword: "Mot de passe...",
                btnLogin: "Connexion",
                btnRegister: "S'inscrire",
                forgotPassword: "MOT DE PASSE OUBLIÉ ?",
                footerNote: "© 2025 Samiha Zeindine. Tous droits réservés.",

                // Register page keys
                registerTitle: "Inscription",
                registerWith: "S'inscrire avec",
                placeholderFullname: "Nom complet...",
                placeholderConfirmPassword: "Confirmer le mot de passe...",
                btnRegisterSubmit: "Créer un compte",
                btnGoToLogin: "Retour à la connexion"
            },
            ar: {
                appName: "سميحة زين الدين للتدريب",
                navHome: "الرئيسية",
                navLogout: "تسجيل الخروج",

                // Login page keys
                loginTitle: "تسجيل الدخول",
                loginWith: "تسجيل الدخول بواسطة",
                orText: "أو",
                placeholderUsername: "اسم المستخدم...",
                placeholderEmail: "البريد الإلكتروني...",
                placeholderPassword: "كلمة المرور...",
                btnLogin: "تسجيل الدخول",
                btnRegister: "إنشاء حساب",
                forgotPassword: "هل نسيت كلمة المرور؟",
                footerNote: "© ٢٠٢٥ سميحة زين الدين. جميع الحقوق محفوظة.",

                // Register page keys
                registerTitle: "إنشاء حساب",
                registerWith: "إنشاء حساب بواسطة",
                placeholderFullname: "الاسم الكامل...",
                placeholderConfirmPassword: "تأكيد كلمة المرور...",
                btnRegisterSubmit: "إنشاء الحساب",
                btnGoToLogin: "العودة لتسجيل الدخول"
            }
        };

        function applyTranslations(lang) {
            const dict = translations[lang] || translations.en;

            // Normal text (elements with data-i18n)
            document.querySelectorAll("[data-i18n]").forEach(el => {
                const key = el.getAttribute("data-i18n");
                if (dict[key]) {
                    el.textContent = dict[key];
                }
            });

            // Placeholders (inputs with data-i18n-placeholder)
            document.querySelectorAll("[data-i18n-placeholder]").forEach(input => {
                const key = input.getAttribute("data-i18n-placeholder");
                if (dict[key]) {
                    input.placeholder = dict[key];
                }
            });

            // Direction + lang attribute
            if (lang === "ar") {
                document.documentElement.lang = "ar";
                document.documentElement.dir = "rtl";
                document.body.classList.add("rtl");
            } else {
                document.documentElement.lang = lang;
                document.documentElement.dir = "ltr";
                document.body.classList.remove("rtl");
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            const selector = document.getElementById("languageSelector");
            const savedLang = localStorage.getItem("siteLanguage") || "en";

            selector.value = savedLang;
            applyTranslations(savedLang);

            selector.addEventListener("change", () => {
                const lang = selector.value;
                localStorage.setItem("siteLanguage", lang);
                applyTranslations(lang);
            });
        });
    </script>

    <!-- 1. Cognito browser library -->
    <script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@6/dist/amazon-cognito-identity.min.js"></script>

    <!-- 2. Your config + helper functions (js/cognito-config.js must exist) -->
    <script src="js/cognito-config.js"></script>

    <!-- 3. Register form handler: calls Cognito sign up -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('registerForm');
            const nameInput = document.getElementById('regName');
            const emailInput = document.getElementById('regEmail');
            const passwordInput = document.getElementById('regPassword');
            const confirmInput = document.getElementById('regConfirmPassword');
            const errorBox = document.getElementById('registerError');
            const successBox = document.getElementById('registerSuccess');

            if (!form) return;

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                errorBox.textContent = '';
                successBox.textContent = '';

                const name = nameInput.value.trim();
                const email = emailInput.value.trim();
                const password = passwordInput.value;
                const confirm = confirmInput.value;

                if (!name || !email || !password || !confirm) {
                    errorBox.textContent = 'Please fill in all fields.';
                    return;
                }

                if (password !== confirm) {
                    errorBox.textContent = 'Passwords do not match.';
                    return;
                }

                if (!window.CognitoAuth || !window.CognitoAuth.cognitoSignUp) {
                    errorBox.textContent = 'Authentication is not initialized. Please try again later.';
                    console.error('CognitoAuth is not available on window.');
                    return;
                }

                try {
                    await window.CognitoAuth.cognitoSignUp(name, email, password);
                    successBox.textContent = 'Account created! Please check your email to confirm your account.';

                    // Optional: redirect after a short delay
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 2000);
                } catch (err) {
                    console.error(err);
                    errorBox.textContent = err.message || 'An error occurred during sign up.';
                }
            });
        });
    </script>
</body>
</html>
