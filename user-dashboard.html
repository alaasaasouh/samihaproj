<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Dashboard - Samiha Zeineddine</title>

  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/dashboard.css">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

  <!-- Cognito Library -->
  <script src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@6/dist/amazon-cognito-identity.min.js"></script>
  <script src="js/cognito-config.js"></script>
</head>

<body>

<!-- ===========================
   1ï¸âƒ£ ACCESS PROTECTION LOGIC
=============================== -->
<script>
document.addEventListener("DOMContentLoaded", async () => {
    const session = await CognitoAuth.getCurrentSession();

    if (!session) {
        window.location.href = "login.html";
        return;
    }

    const token = session.session.getIdToken().payload;
    const groups = token["cognito:groups"] || [];

    // ADMIN CANNOT VIEW USER DASHBOARD
    if (groups.includes("Admin")) {
        window.location.href = "admin-dashboard.html";
        return;
    }
});
</script>


<!-- TOP HEADER -->
<div class="top-header">
  <div class="top-header-left">
    <span class="separator">|</span>
  </div>

  <div class="top-header-right">
    <select class="language-selector" id="languageSelect">
      <option value="en">English</option>
      <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
      <option value="fr">FranÃ§ais</option>
    </select>

    <a href="https://facebook.com/lifecoachbysamiha" target="_blank" class="social-btn fb-btn">FB</a>
    <a href="https://instagram.com/lifecoach.samiha" target="_blank" class="social-btn instagram-btn">IG</a>
    <a href="#" id="logoutBtn" class="login-btn" data-i18n="logout">Logout</a>
  </div>
</div>

<!-- LAYOUT -->
<div class="dashboard-layout">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <button class="close-sidebar-btn" id="closeSidebarBtn">Ã—</button>

      <div class="avatar" id="userAvatar">U</div>

      <div class="user-info">
        <p class="welcome-text" id="userWelcome" data-i18n="welcomeUser">Hi, User</p>
        <p class="subtitle" data-i18n="clientPortal">Client Portal</p>
      </div>
    </div>

    <nav class="sidebar-nav">
      <a href="#" class="nav-item active" data-section="dashboard" data-i18n="navDashboard">ğŸ  Dashboard</a>
      <a href="#" class="nav-item" data-section="tests" data-i18n="navTests">ğŸ“˜ Personality Test Results</a>
      <a href="#" class="nav-item" data-section="questions" data-i18n="navQuestions">â“ Questions for Samiha</a>
      <a href="#" class="nav-item" data-section="personalized" data-i18n="navPersonalized">â­ Personalized Questions</a>
      <a href="#" class="nav-item" data-section="courses" data-i18n="navCourses">ğŸ“š Courses & Programs</a>
      <a href="#" class="nav-item" data-section="payments" data-i18n="navPayments">ğŸ’³ Payments & Invoices</a>
      <a href="#" class="nav-item" data-section="messages" data-i18n="navMessages">ğŸ’¬ Messages & Notifications</a>
      <a href="#" class="nav-item" data-section="settings" data-i18n="navSettings">âš™ï¸ Settings</a>
    </nav>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main-content">

    <header class="dashboard-header">
      <button class="hamburger-menu" id="hamburgerMenu">â˜°</button>
      <h1 class="page-title" id="pageTitle" data-i18n="pageDashboard">Dashboard</h1>

      <div class="header-right">
        <a href="#" id="logoutBtnTop" class="nav-item logout-btn" data-i18n="logout">Logout</a>
      </div>
    </header>

    <!-- ===========================
        DASHBOARD CONTENT
    ============================== -->
    <div class="content-wrapper">

      <section id="dashboard" class="content-section active">
        <div class="dashboard-container">
          <div class="welcome-section">
            <h1 id="welcomeUserTitle" data-i18n="welcomeTitle">Welcome!</h1>
            <p data-i18n="welcomeSubtitle">Your personal coaching overview.</p>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <h3 data-i18n="sessionsCompleted">Sessions Completed</h3>
              <div class="number">0</div>
            </div>
            <div class="stat-card">
              <h3 data-i18n="testsTaken">Tests Taken</h3>
              <div class="number">0</div>
            </div>
            <div class="stat-card">
              <h3 data-i18n="coursesProgress">Courses Progress</h3>
              <div class="number">0%</div>
            </div>
            <div class="stat-card">
              <h3 data-i18n="daysStreak">Days Streak</h3>
              <div class="number">0</div>
            </div>
          </div>

          <div class="quick-actions">
            <h2 data-i18n="quickActions">Quick Actions</h2>
            <div class="actions-grid">
              <button class="action-btn" data-i18n="bookSession">ğŸ“… Book Session</button>
              <button class="action-btn" data-i18n="askQuestion">â“ Ask Question</button>
              <button class="action-btn" data-i18n="reflections">ğŸ’­ Reflections</button>
              <button class="action-btn" data-i18n="continueCourse">ğŸ“š Continue Course</button>
            </div>
          </div>

          <div class="upcoming-sessions">
            <h2 data-i18n="upcomingSessions">Upcoming Sessions</h2>

            <div class="session-item">
              <strong data-i18n="noSessions">No sessions scheduled</strong>
              <p data-i18n="noSessionsDesc">You will see sessions here when booked.</p>
            </div>

          </div>
        </div>
      </section>

      <!-- (All your remaining sections stay the same â€” unchanged UI) -->
      <!-- tests, personalized, courses, payments, messages, settings ... -->

    </div>
  </main>
</div>

<!-- ===========================
   LANGUAGE TRANSLATION SYSTEM
=============================== -->
<script>
const dashboardTranslations = {
  en: {
    logout: "Logout",
    welcomeUser: "Hi, User",
    clientPortal: "Client Portal",
    navDashboard: "ğŸ  Dashboard",
    navTests: "ğŸ“˜ Personality Test Results",
    navQuestions: "â“ Questions for Samiha",
    navPersonalized: "â­ Personalized Questions",
    navCourses: "ğŸ“š Courses & Programs",
    navPayments: "ğŸ’³ Payments & Invoices",
    navMessages: "ğŸ’¬ Messages & Notifications",
    navSettings: "âš™ï¸ Settings",
    pageDashboard: "Dashboard",
    welcomeTitle: "Welcome!",
    welcomeSubtitle: "Your personal coaching overview.",
    sessionsCompleted: "Sessions Completed",
    testsTaken: "Tests Taken",
    coursesProgress: "Courses Progress",
    daysStreak: "Days Streak",
    quickActions: "Quick Actions",
    bookSession: "ğŸ“… Book Session",
    askQuestion: "â“ Ask Question",
    reflections: "ğŸ’­ Reflections",
    continueCourse: "ğŸ“š Continue Course",
    upcomingSessions: "Upcoming Sessions",
    noSessions: "No sessions scheduled",
    noSessionsDesc: "You will see sessions here when booked."
  },
  ar: {
    logout: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
    welcomeUser: "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ",
    clientPortal: "Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„",
    navDashboard: "ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
    navTests: "ğŸ“˜ Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©",
    navQuestions: "â“ Ø£Ø³Ø¦Ù„Ø© Ù„Ø³Ù…ÙŠØ­Ø©",
    navPersonalized: "â­ Ø£Ø³Ø¦Ù„Ø© Ù…Ø®ØµØµØ©",
    navCourses: "ğŸ“š Ø§Ù„Ø¯ÙˆØ±Ø§Øª ÙˆØ§Ù„Ø¨Ø±Ø§Ù…Ø¬",
    navPayments: "ğŸ’³ Ø§Ù„Ø¯ÙØ¹Ø§Øª ÙˆØ§Ù„ÙÙˆØ§ØªÙŠØ±",
    navMessages: "ğŸ’¬ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
    navSettings: "âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
    pageDashboard: "Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",
    welcomeTitle: "Ù…Ø±Ø­Ø¨Ø§Ù‹!",
    welcomeSubtitle: "Ù„Ù…Ø­Ø© Ø¹Ø§Ù…Ø© Ø¹Ù† ØªÙ‚Ø¯Ù…Ùƒ.",
    sessionsCompleted: "Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù…Ù†Ø¬Ø²Ø©",
    testsTaken: "Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ ØªÙ… Ø¥Ø¬Ø±Ø§Ø¤Ù‡Ø§",
    coursesProgress: "ØªÙ‚Ø¯Ù… Ø§Ù„Ø¯ÙˆØ±Ø§Øª",
    daysStreak: "Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…",
    quickActions: "Ø®ÙŠØ§Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©",
    bookSession: "ğŸ“… Ø­Ø¬Ø² Ø¬Ù„Ø³Ø©",
    askQuestion: "â“ Ø§Ø·Ø±Ø­ Ø³Ø¤Ø§Ù„Ø§Ù‹",
    reflections: "ğŸ’­ Ø§Ù„ØªØ£Ù…Ù„Ø§Øª",
    continueCourse: "ğŸ“š Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¯ÙˆØ±Ø©",
    upcomingSessions: "Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©",
    noSessions: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬Ù„Ø³Ø§Øª",
    noSessionsDesc: "Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ù‡Ù†Ø§ Ø¹Ù†Ø¯ Ø­Ø¬Ø²Ù‡Ø§."
  },
  fr: {
    logout: "DÃ©connexion",
    welcomeUser: "Bonjour,",
    clientPortal: "Portail Client",
    navDashboard: "ğŸ  Tableau de bord",
    navTests: "ğŸ“˜ RÃ©sultats des tests",
    navQuestions: "â“ Questions pour Samiha",
    navPersonalized: "â­ Questions personnalisÃ©es",
    navCourses: "ğŸ“š Cours & Programmes",
    navPayments: "ğŸ’³ Paiements & Factures",
    navMessages: "ğŸ’¬ Messages & Notifications",
    navSettings: "âš™ï¸ ParamÃ¨tres",
    pageDashboard: "Tableau de bord",
    welcomeTitle: "Bienvenue!",
    welcomeSubtitle: "Votre aperÃ§u personnalisÃ©.",
    sessionsCompleted: "Sessions terminÃ©es",
    testsTaken: "Tests effectuÃ©s",
    coursesProgress: "Progression des cours",
    daysStreak: "Jours consÃ©cutifs",
    quickActions: "Actions rapides",
    bookSession: "ğŸ“… RÃ©server une session",
    askQuestion: "â“ Poser une question",
    reflections: "ğŸ’­ RÃ©flexions",
    continueCourse: "ğŸ“š Continuer le cours",
    upcomingSessions: "Sessions Ã  venir",
    noSessions: "Aucune sÃ©ance planifiÃ©e",
    noSessionsDesc: "Les sÃ©ances apparaÃ®tront ici une fois rÃ©servÃ©es."
  }
};


// APPLY LANGUAGE
function applyDashboardLang(lang) {
  const dict = dashboardTranslations[lang] || dashboardTranslations.en;

  // Replace text
  document.querySelectorAll("[data-i18n]").forEach(el => {
      el.textContent = dict[el.getAttribute("data-i18n")];
  });

  // RTL/LTR Handling
  if (lang === "ar") {
      document.documentElement.dir = "rtl";
      document.body.classList.add("rtl");
  } else {
      document.documentElement.dir = "ltr";
      document.body.classList.remove("rtl");
  }
}


// LANGUAGE CHANGE HANDLER
document.getElementById("languageSelect").addEventListener("change", () => {
  const lang = document.getElementById("languageSelect").value;
  localStorage.setItem("dashboardLang", lang);
  applyDashboardLang(lang);
});

document.addEventListener("DOMContentLoaded", () => {
  const saved = localStorage.getItem("dashboardLang") || "en";
  document.getElementById("languageSelect").value = saved;
  applyDashboardLang(saved);
});
</script>


<!-- ===========================
   USER LOADING + LOGOUT
=============================== -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const user = getCurrentUser();

  user.getSession((err, session) => {
    if (err || !session.isValid()) {
      window.location.href = "login.html";
      return;
    }

    user.getUserAttributes((err, attrs) => {
      let name = "";
      let email = "";

      attrs.forEach(a => {
        if (a.getName() === "name") name = a.getValue();
        if (a.getName() === "email") email = a.getValue();
      });

      if (!name) name = email.split("@")[0];

      document.getElementById("userWelcome").textContent = "Hi, " + name;
      document.getElementById("welcomeUserTitle").textContent = "Welcome, " + name;

      const initials = name.split(" ").map(x => x[0]).join("").toUpperCase();
      document.getElementById("userAvatar").textContent = initials;
    });
  });

  // LOGOUT
  document.getElementById("logoutBtn").onclick =
  document.getElementById("logoutBtnTop").onclick = () => {
    const u = getCurrentUser();
    if (u) u.signOut();
    window.location.href = "login.html";
  };
});
</script>

</body>
</html>
